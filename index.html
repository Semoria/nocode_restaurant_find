<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
    <title>餐厅推荐系统</title>
    <link rel="icon" type="image/png" href="https://s3plus.meituan.net/nocode-external/assets/nocode-logo.png">
    <link rel="apple-touch-icon" href="https://s3plus.meituan.net/nocode-external/assets/nocode-logo.png">
    <link rel="shortcut icon" href="https://s3plus.meituan.net/nocode-external/assets/nocode-logo.png">
    
    <!-- 预加载百度地图 JS API -->
    <script type="text/javascript">
      // 初始化全局状态
      window.baiduMapAPILoaded = false;
      window.baiduMapAPIFailed = false;
      
      // 百度地图API加载错误处理
      window.baiduMapLoadError = function(error) {
        console.warn('百度地图API加载失败:', error);
        window.baiduMapAPIFailed = true;
        
        // 发送自定义事件通知应用
        window.dispatchEvent(new CustomEvent('baiduMapLoadFailed', { 
          detail: { error: error } 
        }));
      };
      
      // 百度地图API加载成功处理
      window.baiduMapLoadSuccess = function() {
        console.log('百度地图API加载成功');
        window.baiduMapAPILoaded = true;
        
        // 发送自定义事件通知应用
        window.dispatchEvent(new CustomEvent('baiduMapLoadSuccess'));
      };
      
      // 监听网络状态变化
      window.addEventListener('online', function() {
        console.log('网络连接已恢复');
        // 如果之前加载失败，可以尝试重新加载
        if (window.baiduMapAPIFailed && !window.baiduMapAPILoaded) {
          console.log('尝试重新加载百度地图API');
          // 这里可以添加重新加载逻辑
        }
      });
      
      window.addEventListener('offline', function() {
        console.log('网络连接已断开');
      });
    </script>
    
    <!-- 引入百度地图 JS API，使用HTTPS协议 -->
    <script 
      type="text/javascript" 
      src="https://api.map.baidu.com/api?v=2.0&ak=vc0WPRO7moeRnE0t9RDus0vlGFlmgifi&callback=baiduMapLoadSuccess"
      onerror="baiduMapLoadError(this)"
      async>
    </script>
  </head>
  <body>
    <div id="root">
      <!-- 加载中的占位内容 -->
      <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh; background-color: #f8fafc;">
        <div style="text-align: center;">
          <div style="width: 40px; height: 40px; border: 4px solid #e5e7eb; border-top: 4px solid #3b82f6; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 16px;"></div>
          <p style="color: #6b7280; font-size: 16px;">应用加载中...</p>
          <p style="color: #9ca3af; font-size: 12px; margin-top: 8px;">正在初始化地图服务...</p>
        </div>
      </div>
    </div>
    
    <style>
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      /* 确保页面在加载失败时也有基本样式 */
      body {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
    </style>
    
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
